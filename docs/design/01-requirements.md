# 요구사항 정리 - 감성 이커머스 시스템

## 🎯 핵심 기능별 요구사항 분석

### 1. ❤️ 상품 좋아요 기능

기능적 요구사항 ( Functional Requirements )
**Happy Path**

- 로그인한 사용자는 상품에 좋아요를 누를 수 있다
- 이미 좋아요한 상품을 다시 누르면 취소된다

**Constraints**

- 로그인한 사용자만 좋아요 기능 사용 가능
- 존재하는 상품에만 좋아요 가능
- 한 사용자당 하나의 상품에 대해 하나의 좋아요만 가능

**Fail Cases**

- `X-USER-ID` 헤더 누락 → `400 Bad Request` 반환
- 존재하지 않는 사용자 → `404 Not Found` 반환
- 존재하지 않는 상품 → `404 Not Found` 반환
- 좋아요 저장 실패 → `500 Internal Server Error` 반환

비기능적 요구사항 ( Non-Functional Requirements )

- 응답성: 사용자가 좋아요 버튼을 눌렀을 때 500ms 이내에 즉각적으로 UI에 반영되어야 한다.
- 동시성: 사용자가 짧은 시간 안에 좋아요 버튼을 여러 번 클릭해도, 시스템은 요청을 순차적으로 처리하여 데이터의 정합성을 보장해야 한다.
- 확장성: 수백만 사용자의 좋아요 데이터를 효율적으로 처리하고 조회할 수 있도록 데이터베이스 인덱싱 전략이 필요하다.
- 인증: 사용자 인증은 `X-USER-ID` Header를 통해 이루어진다.
- 오류 처리: 오류 발생 시, 명확한 HTTP 상태 코드와 구체적인 에러 메시지를 반환해야 한다.

### 2. 🛒 장바구니 담기 기능

기능적 요구사항 ( Functional Requirements )

> 시스템이 “무엇을” 해야 하는지

- 사용자는 로그인한 상태에서**”만”** 장바구니에 상품을 담을 수 있다.
- 해당 상품이 장바구니에 “이미 존재한다면” 수량을 증가시킨다.
- 장바구니에 “동일한 상품이 없다면” 새 항목을 추가한다.

**Happy Path**

- 사용자는 로그인한 상태에서 장바구니에 상품을 담을 수 있다.
- 해당 상품이 장바구니에 이미 존재한다면 수량을 증가시킨다.
- 장바구니에 동일한 상품이 없다면 새 항목을 추가한다.

**Constraints**

- 로그인한 사용자만 장바구니 기능 사용 가능
- 상품은 '판매중' 상태여야 한다.
- 상품 갯수는 최대 10개까지 허용된다.
- `X-USER-ID` 헤더로 사용자 인증

**Fail Cases**

- 상품이 존재하지 않으면 → `404 Not Found` 반환
- 장바구니 저장이 실패하면 → `500 Internal Server Error` 반환
- 로그인하지 않은 사용자에게는 → `401 Unauthorized` 반환
- 상품이 '판매중'이 아니라면 → `409 Conflict` 반환
- 상품 갯수가 최대 개수 (10개)를 넘어가는 요청의 경우 → `400 Bad Request` 반환
- 동시에 상품 저장을 요청해도 수량이 정확히 증가해야 한다. (동시성 문제)

비기능적 요구사항 ( Non-Functional Requirements )

- 성능: 장바구니 담기 요청은 700ms 이내에 처리되어야 사용자가 지연을 느끼지 않는다.
- 데이터 일관성: 사용자가 여러 기기(모바일, 웹)에서 동시에 접속하더라도 장바구니 상태는 항상 최신으로 동일하게 유지되어야 한다.
- 동시성: 여러 번의 동시 담기 요청에도 상품 수량이 정확하게 증가하도록 원자적(Atomic) 연산을 보장해야 한다.
- 인증: 사용자 인증은 `X-USER-ID` Header를 통해 이루어진다.
- 오류 처리: 오류 발생 시, 명확한 HTTP 상태 코드와 구체적인 에러 메시지를 반환해야 한다.

### 3. 🛒 주문 생성 기능

기능적 요구사항 ( Functional Requirements )
**Happy Path**

- 로그인한 사용자는 여러 상품을 한 번에 주문할 수 있다
- 주문 시 재고가 차감되고 포인트가 차감된다
- 주문 정보는 외부 시스템으로 전송된다

**Constraints**

- 주문 가능한 상품 수량: 각 상품당 1개 이상 99개 이하
- 총 주문 금액이 보유 포인트를 초과하면 안됨
- 모든 상품의 재고가 충분해야 함
- 주문 상품은 최소 1개 이상이어야 한다.
- 주문 시점의 상품 가격으로 결제된다.
- 주문 상품의 옵션(색상, 사이즈 등)이 있다면 해당 옵션도 유효해야 한다.

**Fail Cases**

- `X-USER-ID` 헤더 누락 → `400 Bad Request` 반환
- 존재하지 않는 사용자 → `404 Not Found` 반환
- 존재하지 않는 상품 포함 → `404 Not Found` 반환
- 재고 부족 → `409 Conflict` 반환
- 포인트 부족 → `400 Bad Request` 반환
- 상품 수량이 범위 초과 → `400 Bad Request` 반환
- 주문 저장 실패 → `500 Internal Server Error` 반환
- 주문 상품 목록이 비어있는 경우 → `400 Bad Request` 반환
- 주문 상품 중 현재 판매 중단된 상품이 포함된 경우 → `409 Conflict` 반환
- 주문 상품의 옵션이 유효하지 않은 경우 → `400 Bad Request` 반환
- 외부 시스템 연동 실패 시 (예: 결제 시스템 응답 없음) → `500 Internal Server Error` 반환

비기능적 요구사항 ( Non-Functional Requirements )
- 성능 : 주문 생성의 전체 프로세스는 3초 이내에 완료되어야 한다.
- 데이터 일관성 및 트랜잭션: 재고 차감, 포인트 차감, 주문 정보 생성은 하나의 트랜잭션으로 묶여 원자적으로 처리되어야 하며, 하나라도 실패하면 모든 변경 사항이 롤백되어야 한다.
- 신뢰성: 외부 결제 시스템 연동 실패가 전체 주문 프로세스 실패로 이어지지 않도록, 비동기 처리 및 재시도(Retry) 메커니즘을 도입하여 안정성을 보장해야 한다.
- 감사 기능: 모든 주문 및 포인트 변경 이력은 추적이 가능하도록 로그로 상세히 기록되어야 한다.
- 인증: 사용자 인증은 `X-USER-ID` Header를 통해 이루어진다.
- 오류 처리: 오류 발생 시, 명확한 HTTP 상태 코드와 구체적인 에러 메시지를 반환해야 한다.

### 4. 🔍 상품 목록 조회 기능

기능적 요구사항 ( Functional Requirements )
**Happy Path**

- 사용자는 필터링 및 정렬 조건에 따라 상품 목록을 조회할 수 있다.
- 상품 목록은 페이지 단위로 제공된다.

**Constraints**

- 유효한 필터링 및 정렬 파라미터만 허용된다.
- 페이지 번호는 0 이상이어야 하며, 페이지당 상품 수는 양수여야 한다.
- 존재하지 않는 브랜드 ID로 필터링할 수 없다.

**Fail Cases**

- 유효하지 않은 필터링 또는 정렬 파라미터 → `400 Bad Request` 반환
- 존재하지 않는 브랜드 ID로 필터링 시 → `404 Not Found` 반환
- 서버 내부 오류로 상품 목록 조회 실패 시 → `500 Internal Server Error` 반환

비기능적 요구사항 ( Non-Functional Requirements )

- 성능: 복잡한 필터링 및 정렬 조건에서도 95 percentile(P95) 응답 시간이 1초 이내여야 한다.
- 데이터 최신성: 상품의 가격이나 재고 상태 변경 시, 1분 이내에 검색 결과에 반영되어야 한다.
- 오류 처리: 오류 발생 시, 명확한 HTTP 상태 코드와 구체적인 에러 메시지를 반환해야 한다.


